openapi: 3.1.0

info:
  title: Ready2Race Application API
  description: REST-like API for CSR application Ready2Race
  version: 0.0.1

paths:
  /login:
    post:
      operationId: userLogin
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginRequest'
      responses:
        200:
          description: Successfully logged in, returns relevant user data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LoginDto'
        400:
          $ref: '#/components/responses/400'
        401:
          $ref: '#/components/responses/401'
        429:
          $ref: '#/components/responses/429'
        500:
          $ref: '#/components/responses/500'
    get:
      operationId: checkUserLogin
      responses:
        200:
          description: Already logged in, returns relevant user data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LoginDto'
        204:
          $ref: '#/components/responses/204'
        500:
          $ref: '#/components/responses/500'
    delete:
      operationId: userLogout
      responses:
        204:
          $ref: '#/components/responses/204'
        500:
          $ref: '#/components/responses/500'

  /user:
    get:
      operationId: getUsers
      parameters:
        - $ref: '#/components/parameters/limit'
        - $ref: '#/components/parameters/offset'
        - $ref: '#/components/parameters/sort'
        - $ref: '#/components/parameters/search'
      responses:
        200:
          description: User page successfully retrieved
          content:
            application/json:
              schema:
                type: object
                required:
                  - data
                  - pagination
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/AppUserDto'
                  pagination:
                    $ref: '#/components/schemas/Pagination'
        400:
          $ref: '#/components/responses/400'
        401:
          $ref: '#/components/responses/401'
        403:
          $ref: '#/components/responses/403'
        422:
          $ref: '#/components/responses/422'
        500:
          $ref: '#/components/responses/500'
  /user/{userId}:
    parameters:
      - name: userId
        in: path
        required: true
        schema:
          type: string
          format: uuid
    get:
      operationId: getUser
      responses:
        200:
          description: User successfully retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AppUserDto'
        400:
          $ref: '#/components/responses/400'
        401:
          $ref: '#/components/responses/401'
        403:
          $ref: '#/components/responses/403'
        404:
          $ref: '#/components/responses/404'
        500:
          $ref: '#/components/responses/500'
  /user/registration:
    get:
      operationId: getRegistrations
      parameters:
        - $ref: '#/components/parameters/limit'
        - $ref: '#/components/parameters/offset'
        - $ref: '#/components/parameters/sort'
        - $ref: '#/components/parameters/search'
      responses:
        200:
          description: Registration page successfully retrieved
          content:
            application/json:
              schema:
                type: object
                required:
                  - data
                  - pagination
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/AppUserRegistrationDto'
                  pagination:
                    $ref: '#/components/schemas/Pagination'
        400:
          $ref: '#/components/responses/400'
        401:
          $ref: '#/components/responses/401'
        403:
          $ref: '#/components/responses/403'
        422:
          $ref: '#/components/responses/422'
        500:
          $ref: '#/components/responses/500'
    post:
      operationId: registerUser
      parameters:
        - $ref: '#/components/parameters/challenge'
        - $ref: '#/components/parameters/input'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RegisterRequest'
      responses:
        204:
          description: Registration initiated
        400:
          $ref: '#/components/responses/400'
        404:
          $ref: '#/components/responses/404'
        409:
          $ref: '#/components/responses/409'
        422:
          $ref: '#/components/responses/422'
        500:
          $ref: '#/components/responses/500'
  /user/registration/verify:
    post:
      operationId: verifyUserRegistration
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/VerifyRegistrationRequest'
      responses:
        201:
          description: Registration completed, user added
        400:
          $ref: '#/components/responses/400'
        404:
          $ref: '#/components/responses/404'
        422:
          $ref: '#/components/responses/422'
        500:
          $ref: '#/components/responses/500'
  /user/invitation:
    get:
      operationId: getInvitations
      parameters:
        - $ref: '#/components/parameters/limit'
        - $ref: '#/components/parameters/offset'
        - $ref: '#/components/parameters/sort'
        - $ref: '#/components/parameters/search'
      responses:
        200:
          description: Invitation page successfully retrieved
          content:
            application/json:
              schema:
                type: object
                required:
                  - data
                  - pagination
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/AppUserInvitationDto'
                  pagination:
                    $ref: '#/components/schemas/Pagination'
        400:
          $ref: '#/components/responses/400'
        401:
          $ref: '#/components/responses/401'
        403:
          $ref: '#/components/responses/403'
        422:
          $ref: '#/components/responses/422'
        500:
          $ref: '#/components/responses/500'
    post:
      operationId: inviteUser
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/InviteRequest'
      responses:
        204:
          description: Invitation initiated
        400:
          $ref: '#/components/responses/400'
        409:
          $ref: '#/components/responses/409'
        422:
          $ref: '#/components/responses/422'
        500:
          $ref: '#/components/responses/500'
  /user/invitation/accept:
    post:
      operationId: acceptUserInvitation
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AcceptInvitationRequest'
      responses:
        201:
          description: Invitation accepted, user added
        400:
          $ref: '#/components/responses/400'
        404:
          $ref: '#/components/responses/404'
        422:
          $ref: '#/components/responses/422'
        500:
          $ref: '#/components/responses/500'
  /user/resetPassword:
    post:
      operationId: initPasswordReset
      parameters:
        - $ref: '#/components/parameters/challenge'
        - $ref: '#/components/parameters/input'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PasswordResetInitRequest'
      responses:
        204:
          $ref: '#/components/responses/204'
        404:
          $ref: '#/components/responses/404'
        409:
          $ref: '#/components/responses/409'
        422:
          $ref: '#/components/responses/422'
        429:
          $ref: '#/components/responses/429'
        500:
          $ref: '#/components/responses/500'
  /user/resetPassword/{passwordResetToken}:
    parameters:
      - name: passwordResetToken
        in: path
        required: true
        schema:
          type: string
    put:
      operationId: resetPassword
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PasswordResetRequest'
      responses:
        204:
          $ref: '#/components/responses/204'
        404:
          $ref: '#/components/responses/404'
        422:
          $ref: '#/components/responses/422'
        500:
          $ref: '#/components/responses/500'


  /role:
    post:
      operationId: addRole
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RoleRequest'
      responses:
        201:
          $ref: '#/components/responses/201'
        400:
          $ref: '#/components/responses/400'
        401:
          $ref: '#/components/responses/401'
        403:
          $ref: '#/components/responses/403'
        422:
          $ref: '#/components/responses/422'
        500:
          $ref: '#/components/responses/500'
    get:
      operationId: getRoles
      parameters:
        - $ref: '#/components/parameters/limit'
        - $ref: '#/components/parameters/offset'
        - $ref: '#/components/parameters/sort'
        - $ref: '#/components/parameters/search'
      responses:
        200:
          description: Role page successfully retrieved
          content:
            application/json:
              schema:
                type: object
                required:
                  - data
                  - pagination
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/RoleDto'
                  pagination:
                    $ref: '#/components/schemas/Pagination'
        401:
          $ref: '#/components/responses/401'
        403:
          $ref: '#/components/responses/403'
        500:
          $ref: '#/components/responses/500'
  /role/{roleId}:
    parameters:
      - name: roleId
        in: path
        required: true
        schema:
          type: string
          format: uuid
    put:
      operationId: updateRole
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RoleRequest'
      responses:
        204:
          description: Event successfully updated
        400:
          $ref: '#/components/responses/400'
        401:
          $ref: '#/components/responses/401'
        403:
          $ref: '#/components/responses/403'
        404:
          $ref: '#/components/responses/404'
        422:
          $ref: '#/components/responses/422'
        500:
          $ref: '#/components/responses/500'
    delete:
      operationId: deleteRole
      responses:
        204:
          description: Role successfully deleted
        401:
          $ref: '#/components/responses/401'
        403:
          $ref: '#/components/responses/403'
        404:
          $ref: '#/components/responses/404'
        500:
          $ref: '#/components/responses/500'

  /event:
    post:
      operationId: addEvent
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EventRequest'
      responses:
        201:
          $ref: '#/components/responses/201'
        400:
          $ref: '#/components/responses/400'
        401:
          $ref: '#/components/responses/401'
        403:
          $ref: '#/components/responses/403'
        422:
          $ref: '#/components/responses/422'
        500:
          $ref: '#/components/responses/500'
    get:
      operationId: getEvents
      parameters:
        - $ref: '#/components/parameters/limit'
        - $ref: '#/components/parameters/offset'
        - $ref: '#/components/parameters/sort'
        - $ref: '#/components/parameters/search'
      responses:
        200:
          description: Event page successfully retrieved
          content:
            application/json:
              schema:
                type:
                  object
                required:
                  - data
                  - pagination
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/EventDto'
                  pagination:
                    $ref: '#/components/schemas/Pagination'
        401:
          $ref: '#/components/responses/401'
        403:
          $ref: '#/components/responses/403'
        500:
          $ref: '#/components/responses/500'
  /event/{eventId}:
    parameters:
      - $ref: '#/components/parameters/eventId'
    get:
      operationId: getEvent
      responses:
        200:
          description: Event successfully retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EventDto'
        400:
          $ref: '#/components/responses/400'
        401:
          $ref: '#/components/responses/401'
        403:
          $ref: '#/components/responses/403'
        404:
          $ref: '#/components/responses/404'
        500:
          $ref: '#/components/responses/500'
    put:
      operationId: updateEvent
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EventRequest'
      responses:
        204:
          description: Event successfully updated
        400:
          $ref: '#/components/responses/400'
        401:
          $ref: '#/components/responses/401'
        403:
          $ref: '#/components/responses/403'
        404:
          $ref: '#/components/responses/404'
        500:
          $ref: '#/components/responses/500'
    delete:
      operationId: deleteEvent
      responses:
        204:
          description: Event successfully deleted
        401:
          $ref: '#/components/responses/401'
        403:
          $ref: '#/components/responses/403'
        404:
          $ref: '#/components/responses/404'
        500:
          $ref: '#/components/responses/500'
  /event/{eventId}/eventDay:
    parameters:
      - $ref: '#/components/parameters/eventId'
    post:
      operationId: addEventDay
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EventDayRequest'
      responses:
        201:
          $ref: '#/components/responses/201'
        400:
          $ref: '#/components/responses/400'
        401:
          $ref: '#/components/responses/401'
        403:
          $ref: '#/components/responses/403'
        404:
          $ref: '#/components/responses/404'
        500:
          $ref: '#/components/responses/500'
    get:
      operationId: getEventDays
      parameters:
        - $ref: '#/components/parameters/limit'
        - $ref: '#/components/parameters/offset'
        - $ref: '#/components/parameters/sort'
        - $ref: '#/components/parameters/search'
        - name: competitionId
          in: query
          schema:
            type: string
            format: uuid
          description: Optional parameter that filters by competitionId
          required: false
      responses:
        200:
          description: EventDay page successfully retrieved
          content:
            application/json:
              schema:
                type:
                  object
                required:
                  - data
                  - pagination
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/EventDayDto'
                  pagination:
                    $ref: '#/components/schemas/Pagination'
        401:
          $ref: '#/components/responses/401'
        403:
          $ref: '#/components/responses/403'
        404:
          $ref: '#/components/responses/404'
        500:
          $ref: '#/components/responses/500'
  /event/{eventId}/eventDay/{eventDayId}:
    parameters:
      - $ref: '#/components/parameters/eventId'
      - $ref: '#/components/parameters/eventDayId'
    get:
      operationId: getEventDay
      responses:
        200:
          description: EventDay successfully retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EventDayDto'
        400:
          $ref: '#/components/responses/400'
        401:
          $ref: '#/components/responses/401'
        403:
          $ref: '#/components/responses/403'
        404:
          $ref: '#/components/responses/404'
        500:
          $ref: '#/components/responses/500'
    put:
      operationId: updateEventDay
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EventDayRequest'
      responses:
        204:
          description: EventDay successfully updated
        400:
          $ref: '#/components/responses/400'
        401:
          $ref: '#/components/responses/401'
        403:
          $ref: '#/components/responses/403'
        404:
          $ref: '#/components/responses/404'
        500:
          $ref: '#/components/responses/500'
    delete:
      operationId: deleteEventDay
      responses:
        204:
          description: EventDay successfully deleted
        401:
          $ref: '#/components/responses/401'
        403:
          $ref: '#/components/responses/403'
        404:
          $ref: '#/components/responses/404'
        500:
          $ref: '#/components/responses/500'
  /event/{eventId}/eventDay/{eventDayId}/competitions:
    parameters:
      - $ref: '#/components/parameters/eventId'
      - $ref: '#/components/parameters/eventDayId'
    put:
      operationId: assignCompetitionsToEventDay
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AssignCompetitionsToDayRequest'
      responses:
        204:
          description: Competitions successfully assigned to day
        400:
          $ref: '#/components/responses/400'
        401:
          $ref: '#/components/responses/401'
        403:
          $ref: '#/components/responses/403'
        404:
          $ref: '#/components/responses/404'
        500:
          $ref: '#/components/responses/500'
  /event/{eventId}/competition:
    parameters:
      - $ref: '#/components/parameters/eventId'
    post:
      operationId: addCompetition
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CompetitionRequest'
      responses:
        201:
          $ref: '#/components/responses/201'
        400:
          $ref: '#/components/responses/400'
        401:
          $ref: '#/components/responses/401'
        403:
          $ref: '#/components/responses/403'
        404:
          $ref: '#/components/responses/404'
        500:
          $ref: '#/components/responses/500'
    get:
      operationId: getCompetitions
      parameters:
        - $ref: '#/components/parameters/limit'
        - $ref: '#/components/parameters/offset'
        - $ref: '#/components/parameters/sort'
        - $ref: '#/components/parameters/search'
        - name: eventDayId
          in: query
          schema:
            type: string
            format: uuid
          description: Optional parameter that filters by eventDayId
          required: false
      responses:
        200:
          description: Competition page successfully retrieved
          content:
            application/json:
              schema:
                type:
                  object
                required:
                  - data
                  - pagination
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/CompetitionDto'
                  pagination:
                    $ref: '#/components/schemas/Pagination'
        401:
          $ref: '#/components/responses/401'
        403:
          $ref: '#/components/responses/403'
        404:
          $ref: '#/components/responses/404'
        500:
          $ref: '#/components/responses/500'
  /event/{eventId}/competition/{competitionId}:
    parameters:
      - $ref: '#/components/parameters/eventId'
      - $ref: '#/components/parameters/competitionId'
    get:
      operationId: getCompetition
      responses:
        200:
          description: Competition successfully retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CompetitionDto'
        400:
          $ref: '#/components/responses/400'
        401:
          $ref: '#/components/responses/401'
        403:
          $ref: '#/components/responses/403'
        404:
          $ref: '#/components/responses/404'
        500:
          $ref: '#/components/responses/500'
    put:
      operationId: updateCompetition
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CompetitionRequest'
      responses:
        204:
          description: Competition successfully updated
        400:
          $ref: '#/components/responses/400'
        401:
          $ref: '#/components/responses/401'
        403:
          $ref: '#/components/responses/403'
        404:
          $ref: '#/components/responses/404'
        500:
          $ref: '#/components/responses/500'
    delete:
      operationId: deleteCompetition
      responses:
        204:
          description: Competition successfully deleted
        401:
          $ref: '#/components/responses/401'
        403:
          $ref: '#/components/responses/403'
        404:
          $ref: '#/components/responses/404'
        500:
          $ref: '#/components/responses/500'
  /event/{eventId}/competition/{competitionId}/days:
    parameters:
      - $ref: '#/components/parameters/eventId'
      - $ref: '#/components/parameters/competitionId'
    put:
      operationId: assignDaysToCompetition
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AssignDaysToCompetitionRequest'
      responses:
        204:
          description: Days successfully assigned to competition
        400:
          $ref: '#/components/responses/400'
        401:
          $ref: '#/components/responses/401'
        403:
          $ref: '#/components/responses/403'
        404:
          $ref: '#/components/responses/404'
        500:
          $ref: '#/components/responses/500'
  /competitionTemplate:
    post:
      operationId: addCompetitionTemplate
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CompetitionTemplateRequest'
      responses:
        201:
          $ref: '#/components/responses/201'
        400:
          $ref: '#/components/responses/400'
        401:
          $ref: '#/components/responses/401'
        403:
          $ref: '#/components/responses/403'
        500:
          $ref: '#/components/responses/500'
    get:
      operationId: getCompetitionTemplates
      parameters:
        - $ref: '#/components/parameters/limit'
        - $ref: '#/components/parameters/offset'
        - $ref: '#/components/parameters/sort'
        - $ref: '#/components/parameters/search'
      responses:
        200:
          description: CompetitionTemplate page successfully retrieved
          content:
            application/json:
              schema:
                type:
                  object
                required:
                  - data
                  - pagination
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/CompetitionTemplateDto'
                  pagination:
                    $ref: '#/components/schemas/Pagination'
        401:
          $ref: '#/components/responses/401'
        403:
          $ref: '#/components/responses/403'
        500:
          $ref: '#/components/responses/500'
  /competitionTemplate/{competitionTemplateId}:
    parameters:
      - name: competitionTemplateId
        in: path
        required: true
        schema:
          type: string
          format: uuid
    get:
      operationId: getCompetitionTemplate
      responses:
        200:
          description: CompetitionTemplate successfully retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CompetitionTemplateDto'
        400:
          $ref: '#/components/responses/400'
        401:
          $ref: '#/components/responses/401'
        403:
          $ref: '#/components/responses/403'
        404:
          $ref: '#/components/responses/404'
        500:
          $ref: '#/components/responses/500'
    put:
      operationId: updateCompetitionTemplate
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CompetitionTemplateRequest'
      responses:
        204:
          description: CompetitionTemplate successfully updated
        400:
          $ref: '#/components/responses/400'
        401:
          $ref: '#/components/responses/401'
        403:
          $ref: '#/components/responses/403'
        404:
          $ref: '#/components/responses/404'
        500:
          $ref: '#/components/responses/500'
    delete:
      operationId: deleteCompetitionTemplate
      responses:
        204:
          description: CompetitionTemplate successfully deleted
        401:
          $ref: '#/components/responses/401'
        403:
          $ref: '#/components/responses/403'
        404:
          $ref: '#/components/responses/404'
        500:
          $ref: '#/components/responses/500'
  /namedParticipant:
    post:
      operationId: addNamedParticipant
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/NamedParticipantRequest'
      responses:
        201:
          $ref: '#/components/responses/201'
        400:
          $ref: '#/components/responses/400'
        401:
          $ref: '#/components/responses/401'
        403:
          $ref: '#/components/responses/403'
        500:
          $ref: '#/components/responses/500'
    get:
      operationId: getNamedParticipants
      responses:
        200:
          description: NamedParticipant list successfully retrieved
          content:
            application/json:
              schema:
                type:
                  object
                required:
                  - data
                  - pagination
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/NamedParticipantDto'
                  pagination:
                    $ref: '#/components/schemas/Pagination'
        401:
          $ref: '#/components/responses/401'
        403:
          $ref: '#/components/responses/403'
        500:
          $ref: '#/components/responses/500'
  /namedParticipant/{namedParticipantId}:
    parameters:
      - name: namedParticipantId
        in: path
        required: true
        schema:
          type: string
          format: uuid
    put:
      operationId: updateNamedParticipant
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/NamedParticipantRequest'
      responses:
        204:
          description: NamedParticipant successfully updated
        400:
          $ref: '#/components/responses/400'
        401:
          $ref: '#/components/responses/401'
        403:
          $ref: '#/components/responses/403'
        404:
          $ref: '#/components/responses/404'
        500:
          $ref: '#/components/responses/500'
    delete:
      operationId: deleteNamedParticipant
      responses:
        204:
          description: NamedParticipant successfully deleted
        401:
          $ref: '#/components/responses/401'
        403:
          $ref: '#/components/responses/403'
        404:
          $ref: '#/components/responses/404'
        409:
          $ref: '#/components/responses/409'
        500:
          $ref: '#/components/responses/500'
  /competitionCategory:
    post:
      operationId: addCompetitionCategory
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CompetitionCategoryRequest'
      responses:
        201:
          $ref: '#/components/responses/201'
        400:
          $ref: '#/components/responses/400'
        401:
          $ref: '#/components/responses/401'
        403:
          $ref: '#/components/responses/403'
        500:
          $ref: '#/components/responses/500'
    get:
      operationId: getCompetitionCategories
      responses:
        200:
          description: CompetitionCategory list successfully retrieved
          content:
            application/json:
              schema:
                type:
                  object
                required:
                  - data
                  - pagination
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/CompetitionCategoryDto'
                  pagination:
                    $ref: '#/components/schemas/Pagination'
        401:
          $ref: '#/components/responses/401'
        403:
          $ref: '#/components/responses/403'
        500:
          $ref: '#/components/responses/500'
  /competitionCategory/{competitionCategoryId}:
    parameters:
      - name: competitionCategoryId
        in: path
        required: true
        schema:
          type: string
          format: uuid
    put:
      operationId: updateCompetitionCategory
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CompetitionCategoryRequest'
      responses:
        204:
          description: CompetitionCategory successfully updated
        400:
          $ref: '#/components/responses/400'
        401:
          $ref: '#/components/responses/401'
        403:
          $ref: '#/components/responses/403'
        404:
          $ref: '#/components/responses/404'
        500:
          $ref: '#/components/responses/500'
    delete:
      operationId: deleteCompetitionCategory
      responses:
        204:
          description: CompetitionCategory successfully deleted
        401:
          $ref: '#/components/responses/401'
        403:
          $ref: '#/components/responses/403'
        404:
          $ref: '#/components/responses/404'
        500:
          $ref: '#/components/responses/500'
  /captcha:
    post:
      operationId: newCaptcha
      responses:
        200:
          description: New Captcha successfully created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CaptchaDto'
        500:
          $ref: '#/components/responses/500'

  /eventDocumentType:
    post:
      operationId: addDocumentType
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EventDocumentTypeRequest'
      responses:
        201:
          $ref: '#/components/responses/201'
        400:
          $ref: '#/components/responses/400'
        401:
          $ref: '#/components/responses/401'
        403:
          $ref: '#/components/responses/403'
        422:
          $ref: '#/components/responses/422'
        500:
          $ref: '#/components/responses/500'
    get:
      operationId: getDocumentTypes
      parameters:
        - $ref: '#/components/parameters/limit'
        - $ref: '#/components/parameters/offset'
        - $ref: '#/components/parameters/sort'
        - $ref: '#/components/parameters/search'
      responses:
        200:
          content:
            application/json:
              schema:
                type:
                  object
                required:
                  - data
                  - pagination
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/EventDocumentTypeDto'
                  pagination:
                    $ref: '#/components/schemas/Pagination'
        400:
          $ref: '#/components/responses/400'
        401:
          $ref: '#/components/responses/401'
        403:
          $ref: '#/components/responses/403'
        500:
          $ref: '#/components/responses/500'
  /eventDocumentType/{eventDocumentTypeId}:
    parameters:
      - name: eventDocumentTypeId
        in: path
        required: true
        schema:
          type: string
          format: uuid
    put:
      operationId: updateDocumentType
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EventDocumentTypeRequest'
      responses:
        204:
          $ref: '#/components/responses/204'
        400:
          $ref: '#/components/responses/400'
        401:
          $ref: '#/components/responses/401'
        403:
          $ref: '#/components/responses/403'
        404:
          $ref: '#/components/responses/404'
        422:
          $ref: '#/components/responses/422'
        500:
          $ref: '#/components/responses/500'
    delete:
      operationId: deleteDocumentType
      responses:
        204:
          $ref: '#/components/responses/204'
        400:
          $ref: '#/components/responses/400'
        401:
          $ref: '#/components/responses/401'
        403:
          $ref: '#/components/responses/403'
        404:
          $ref: '#/components/responses/404'
        500:
          $ref: '#/components/responses/500'
  /event/{eventId}/eventDocument:
    parameters:
      - name: eventId
        in: path
        required: true
        schema:
          type: string
          format: uuid
    post:
      operationId: addDocuments
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                documentType:
                  type: string
                files:
                  type: array
                  items:
                    type: string
                    format: binary
      responses:
        204:
          $ref: '#/components/responses/204'
        400:
          $ref: '#/components/responses/400'
        401:
          $ref: '#/components/responses/401'
        403:
          $ref: '#/components/responses/403'
        422:
          $ref: '#/components/responses/422'
        500:
          $ref: '#/components/responses/500'
    get:
      operationId: getDocuments
      parameters:
        - name: documentType
          in: query
          required: false
          schema:
            type: string
            format: uuid
        - $ref: '#/components/parameters/limit'
        - $ref: '#/components/parameters/offset'
        - $ref: '#/components/parameters/sort'
        - $ref: '#/components/parameters/search'
      responses:
        200:
          content:
            application/json:
              schema:
                type:
                  object
                required:
                  - data
                  - pagination
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/EventDocumentDto'
                  pagination:
                    $ref: '#/components/schemas/Pagination'
        400:
          $ref: '#/components/responses/400'
        401:
          $ref: '#/components/responses/401'
        403:
          $ref: '#/components/responses/403'
        422:
          $ref: '#/components/responses/422'
        500:
          $ref: '#/components/responses/500'
  /event/{eventId}/eventDocument/{eventDocumentId}:
    parameters:
      - name: eventId
        in: path
        required: true
        schema:
          type: string
          format: uuid
      - name: eventDocumentId
        in: path
        required: true
        schema:
          type: string
          format: uuid
    get:
      operationId: downloadDocument
      responses:
        200:
          headers:
            Content-Disposition:
              schema:
                type: string
          content:
            '*/*':
              schema:
                type: string
                format: binary
        400:
          $ref: '#/components/responses/400'
        401:
          $ref: '#/components/responses/401'
        403:
          $ref: '#/components/responses/403'
        404:
          $ref: '#/components/responses/404'
        500:
          $ref: '#/components/responses/500'
    put:
      operationId: updateDocument
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EventDocumentRequest'
      responses:
        204:
          $ref: '#/components/responses/204'
        400:
          $ref: '#/components/responses/400'
        401:
          $ref: '#/components/responses/401'
        403:
          $ref: '#/components/responses/403'
        404:
          $ref: '#/components/responses/404'
        422:
          $ref: '#/components/responses/422'
        500:
          $ref: '#/components/responses/500'
    delete:
      operationId: deleteDocument
      responses:
        204:
          $ref: '#/components/responses/204'
        400:
          $ref: '#/components/responses/400'
        401:
          $ref: '#/components/responses/401'
        403:
          $ref: '#/components/responses/403'
        404:
          $ref: '#/components/responses/404'
        500:
          $ref: '#/components/responses/500'

components:

  parameters:

    # query

    limit:
      name: limit
      in: query
      description: Page size for pagination
      required: false
      schema:
        type: integer

    offset:
      name: offset
      in: query
      description: Result offset for pagination
      required: false
      schema:
        type: integer

    sort:
      name: sort
      in: query
      description: "Fields with direction (as JSON [{field: <field>, direction: ASC | DESC}, ...]) sorting result for pagination"
      required: false
      schema:
        type: string

    search:
      name: search
      in: query
      description: Filter result with space-separated search terms for pagination
      required: false
      schema:
        type: string


    challenge:
      name: challenge
      in: query
      description: Captcha challenge id
      required: true
      schema:
        type: string
        format: uuid

    input:
      name: input
      in: query
      description: Captcha solution
      required: true
      schema:
        type: integer


    # path params

    eventId:
      name: eventId
      in: path
      required: true
      schema:
        type: string
        format: uuid

    eventDayId:
      name: eventDayId
      in: path
      required: true
      schema:
        type: string
        format: uuid

    competitionId:
      name: competitionId
      in: path
      required: true
      schema:
        type: string
        format: uuid



  responses:

    201:
      description: Entity successfully created, returns the id
      content:
        application/json:
          schema:
            type: string
            format: uuid

    204:
      description: No Content

    400:
      description: Bad Request
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/BadRequestError'

    401:
      description: Unauthorized
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ApiError'

    403:
      description: Forbidden
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ApiError'

    404:
      description: Not Found
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ApiError'

    409:
      description: Conflict
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ApiError'

    422:
      description: Unprocessable
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/UnprocessableEntityError'

    429:
      description: Too many requests
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/TooManyRequestsError'

    500:
      description: Server Error
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ApiError'


    409EmailInUse:
      description: Conflict
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/UnprocessableEntityError'

  schemas:

    # enums

    Action:
      type: string
      enum:
        - CREATE
        - READ
        - UPDATE
        - DELETE

    Resource:
      type: string
      enum:
        - USER
        - EVENT

    Scope:
      type: string
      enum:
        - OWN
        - GLOBAL

    EmailLanguage:
      type: string
      enum:
        - DE
        - EN

    ErrorCode:
      type: string
      enum:
        - CAPTCHA_WRONG
        - EMAIL_IN_USE


    # error

    ApiError:
      type: object
      required:
        - status
        - message
      properties:
        status:
          type: object
          required:
            - value
            - description
          properties:
            value:
              type: number
            description:
              type: string
        message:
          type: string
        errorCode:
          $ref: '#/components/schemas/ErrorCode'


    BadRequestError:
      allOf:
        - $ref: '#/components/schemas/ApiError'
        - type: object
          properties:
            details:
              type: object
              properties:
                validExample: { }


    UnprocessableEntityError:
      allOf:
        - $ref: '#/components/schemas/ApiError'
        - type: object
          required:
            - details
          properties:
            details:
              oneOf:
                - type: object
                  required:
                    - reason
                  properties:
                    reason:
                      $ref: '#/components/schemas/Invalid'
                - type: object
                  required:
                    - result
                  properties:
                    result:
                      $ref: '#/components/schemas/Invalid'


    TooManyRequestsError:
      allOf:
        - $ref: '#/components/schemas/ApiError'
        - type: object
          required:
            - details
          properties:
            details:
              type: object
              required:
                - retryAfter
              properties:
                retryAfter:
                  type: integer

    Invalid:
      oneOf:
        - type: string
        - type: object
          required:
            - field
            - error
          properties:
            field:
              type: string
            error:
              $ref: '#/components/schemas/Invalid'
        - type: object
          required:
            - errorPositions
          properties:
            errorPositions: { }
        - $ref: '#/components/schemas/Duplicate'
        - type: object
          required:
            - duplicates
          properties:
            duplicates:
              type: array
              items:
                $ref: '#/components/schemas/Duplicate'
        - type: object
          required:
            - value
            - pattern
          properties:
            value:
              type: string
            pattern:
              type: string
        - type: object
          required:
            - allOf
          properties:
            allOf:
              type: array
              items:
                $ref: '#/components/schemas/Invalid'
        - type: object
          required:
            - anyOf
          properties:
            anyOf:
              type: array
              items:
                $ref: '#/components/schemas/Invalid'
        - type: object
          required:
            - oneOf
          properties:
            oneOf:
              type: array
              items:
                oneOf:
                  - $ref: '#/components/schemas/Invalid'
                  - type: object



    Duplicate:
      type: object
      required:
        - value
        - count
      properties:
        value: { }
        count:
          type: integer



    # authentication / authorization

    LoginRequest:
      type: object
      required:
        - email
        - password
      properties:
        email:
          type: string
        password:
          type: string

    Privilege:
      type: object
      required:
        - action
        - resource
        - scope
      properties:
        action:
          $ref: '#/components/schemas/Action'
        resource:
          $ref: '#/components/schemas/Resource'
        scope:
          $ref: '#/components/schemas/Scope'

    PrivilegeDto:
      type: object
      required:
        - id
        - action
        - resource
        - scope
      properties:
        id:
          type: string
          format: uuid
        action:
          $ref: '#/components/schemas/Action'
        resource:
          $ref: '#/components/schemas/Resource'
        scope:
          $ref: '#/components/schemas/Scope'

    LoginDto:
      type: object
      required:
        - id
        - privileges
      properties:
        id:
          type: string
          format: uuid
        privileges:
          type: array
          items:
            $ref: '#/components/schemas/PrivilegeDto'


    # pagination

    Pagination:
      type: object
      required:
        - total
        - limit
        - offset
        - sort
        - search
      properties:
        total:
          type: integer
        limit:
          type: integer
        offset:
          type: integer
        sort:
          type: array
          items:
            $ref: '#/components/schemas/Order'
        search:
          type: string

    Order:
      type: object
      required:
        - field
        - direction
      properties:
        field:
          type: string
        direction:
          type: string
          enum:
            - ASC
            - DESC

    # email

    AssignedEmailDto:
      type: object
      required:
        - recipient
      properties:
        recipient:
          type: string
        sentAt:
          type: string
          format: date-time
        lastErrorAt:
          type: string
          format: date-time
        lastError:
          type: string


    # user

    AppUserNameDto:
      type: object
      required:
        - firstname
        - lastname
      properties:
        firstname:
          type: string
        lastname:
          type: string

    AppUserDto:
      type: object
      required:
        - id
        - email
        - firstname
        - lastname
        - roles
      properties:
        id:
          type: string
          format: uuid
        email:
          type: string
        firstname:
          type: string
        lastname:
          type: string
        roles:
          type: array
          items:
            $ref: '#/components/schemas/RoleDto'

    AppUserRegistrationDto:
      type: object
      required:
        - id
        - email
        - firstname
        - lastname
        - language
        - expiresAt
        - createdAt
      properties:
        id:
          type: string
          format: uuid
        email:
          type: string
        firstname:
          type: string
        lastname:
          type: string
        language:
          $ref: '#/components/schemas/EmailLanguage'
        expiresAt:
          type: string
          format: date-time
        createdAt:
          type: string
          format: date-time
        assignedEmail:
          $ref: '#/components/schemas/AssignedEmailDto'

    RegisterRequest:
      type: object
      required:
        - email
        - password
        - firstname
        - lastname
        - language
        - callbackUrl
      properties:
        email:
          type: string
        password:
          type: string
        firstname:
          type: string
        lastname:
          type: string
        language:
          $ref: '#/components/schemas/EmailLanguage'
        callbackUrl:
          type: string
          format: url

    VerifyRegistrationRequest:
      type: object
      required:
        - token
      properties:
        token:
          type: string

    AppUserInvitationDto:
      type: object
      required:
        - id
        - email
        - firstname
        - lastname
        - language
        - expiresAt
        - createdAt
        - roles
      properties:
        id:
          type: string
          format: uuid
        email:
          type: string
        firstname:
          type: string
        lastname:
          type: string
        language:
          $ref: '#/components/schemas/EmailLanguage'
        expiresAt:
          type: string
          format: date-time
        createdAt:
          type: string
          format: date-time
        assignedEmail:
          $ref: '#/components/schemas/AssignedEmailDto'
        roles:
          type: array
          items:
            $ref: '#/components/schemas/RoleDto'
        createdBy:
          $ref: '#/components/schemas/AppUserNameDto'

    InviteRequest:
      type: object
      required:
        - email
        - firstname
        - lastname
        - language
        - roles
        - callbackUrl
      properties:
        email:
          type: string
        firstname:
          type: string
        lastname:
          type: string
        language:
          $ref: '#/components/schemas/EmailLanguage'
        roles:
          type: array
          items:
            type: string
            format: uuid
        callbackUrl:
          type: string
          format: url

    AcceptInvitationRequest:
      type: object
      required:
        - token
        - password
      properties:
        token:
          type: string
        password:
          type: string


    PasswordResetInitRequest:
      type: object
      required:
        - email
        - language
        - callbackUrl
      properties:
        email:
          type: string
        language:
          $ref: '#/components/schemas/EmailLanguage'
        callbackUrl:
          type: string
          format: url

    PasswordResetRequest:
      type: object
      required:
        - password
      properties:
        password:
          type: string


    # role

    RoleDto:
      type: object
      required:
        - id
        - name
        - privileges
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
        privileges:
          type: array
          items:
            $ref: '#/components/schemas/PrivilegeDto'

    RoleRequest:
      type: object
      required:
        - name
        - privileges
      properties:
        name:
          type: string
        description:
          type: string
        privileges:
          type: array
          items:
            type: string
            format: uuid

    # event

    EventDto:
      type: object
      required:
        - id
        - name
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
        location:
          type: string
        registrationAvailableFrom:
          type: string
          format: date-time
        registrationAvailableTo:
          type: string
          format: date-time
        invoicePrefix:
          type: string

    EventRequest:
      type: object
      required:
        - name
      properties:
        name:
          type: string
        description:
          type: string
        location:
          type: string
        registrationAvailableFrom:
          type: string
          format: date-time
        registrationAvailableTo:
          type: string
          format: date-time
        invoicePrefix:
          type: string



    # eventDay

    EventDayDto:
      type: object
      required:
        - id
        - event
        - date
      properties:
        id:
          type: string
          format: uuid
        event:
          type: string
          format: uuid
        date:
          type: string
          format: date
        name:
          type: string
        description:
          type: string

    EventDayRequest:
      type: object
      required:
        - date
      properties:
        date:
          type: string
          format: date
        name:
          type: string
        description:
          type: string


    AssignCompetitionsToDayRequest:
      type: object
      required:
        - competitions
      properties:
        competitions:
          type: array
          items:
            type: string
            format: uuid



    # competitionProperties

    CompetitionPropertiesDto:
      type: object
      required:
        - identifier
        - name
        - countMales
        - countFemales
        - countNonBinary
        - countMixed
        - namedParticipants
      properties:
        identifier:
          type: string
        name:
          type: string
        shortName:
          type: string
        description:
          type: string
        countMales:
          type: integer
        countFemales:
          type: integer
        countNonBinary:
          type: integer
        countMixed:
          type: integer
        competitionCategory:
          $ref: '#/components/schemas/CompetitionCategoryDto'
        namedParticipants:
          type: array
          items:
            $ref: '#/components/schemas/NamedParticipantForCompetitionDto'


    NamedParticipantForCompetitionDto:
      type: object
      required:
        - id
        - name
        - required
        - countMales
        - countFemales
        - countNonBinary
        - countMixed
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
        required:
          type: boolean
        countMales:
          type: integer
        countFemales:
          type: integer
        countNonBinary:
          type: integer
        countMixed:
          type: integer


    CompetitionPropertiesRequestDto:
      type: object
      required:
        - identifier
        - name
        - countMales
        - countFemales
        - countNonBinary
        - countMixed
        - namedParticipants
      properties:
        identifier:
          type: string
        name:
          type: string
        shortName:
          type: string
        description:
          type: string
        countMales:
          type: integer
        countFemales:
          type: integer
        countNonBinary:
          type: integer
        countMixed:
          type: integer
        competitionCategory:
          type: string
          format: uuid
        namedParticipants:
          type: array
          items:
            $ref: '#/components/schemas/NamedParticipantForCompetitionRequestDto'


    NamedParticipantForCompetitionRequestDto:
      type: object
      required:
        - namedParticipant
        - required
        - countMales
        - countFemales
        - countNonBinary
        - countMixed
      properties:
        namedParticipant:
          type: string
          format: uuid
        required:
          type: boolean
        countMales:
          type: integer
        countFemales:
          type: integer
        countNonBinary:
          type: integer
        countMixed:
          type: integer



    # competition

    CompetitionDto:
      type: object
      required:
        - id
        - event
        - properties
      properties:
        id:
          type: string
          format: uuid
        event:
          type: string
          format: uuid
        properties:
          $ref: '#/components/schemas/CompetitionPropertiesDto'
        template:
          type: string
          format: uuid


    CompetitionRequest:
      type: object
      properties:
        properties:
          $ref: '#/components/schemas/CompetitionPropertiesRequestDto'
        template:
          type: string
          format: uuid


    AssignDaysToCompetitionRequest:
      type: object
      required:
        - days
      properties:
        days:
          type: array
          items:
            type: string
            format: uuid



    # competitionTemplate

    CompetitionTemplateDto:
      type: object
      required:
        - id
        - properties
      properties:
        id:
          type: string
          format: uuid
        properties:
          $ref: '#/components/schemas/CompetitionPropertiesDto'


    CompetitionTemplateRequest:
      type: object
      required:
        - properties
      properties:
        properties:
          $ref: '#/components/schemas/CompetitionPropertiesRequestDto'



    # namedParticipant

    NamedParticipantDto:
      type: object
      required:
        - id
        - name
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string

    NamedParticipantRequest:
      type: object
      required:
        - name
      properties:
        name:
          type: string
        description:
          type: string


    # competitionCategory

    CompetitionCategoryDto:
      type: object
      required:
        - id
        - name
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string

    CompetitionCategoryRequest:
      type: object
      required:
        - name
      properties:
        name:
          type: string
        description:
          type: string

    # captcha

    CaptchaDto:
      type: object
      required:
        - id
        - imgSrc
        - solutionMin
        - solutionMax
        - handleToHeightRatio
        - start
      properties:
        id:
          type: string
          format: uuid
        imgSrc:
          type: string
          format: base64
        solutionMin:
          type: integer
        solutionMax:
          type: integer
        handleToHeightRatio:
          type: number
        start:
          type: integer

    # eventDocuments

    EventDocumentTypeRequest:
      type: object
      required:
        - name
        - required
        - confirmationRequired
      properties:
        name:
          type: string
        required:
          type: boolean
        confirmationRequired:
          type: boolean

    EventDocumentTypeDto:
      type: object
      required:
        - id
        - name
        - required
        - confirmationRequired
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        required:
          type: boolean
        confirmationRequired:
          type: boolean

    EventDocumentRequest:
      type: object
      properties:
        documentType:
          type: string
          format: uuid

    EventDocumentDto:
      type: object
      required:
        - id
        - name
        - createdAt
        - updatedAt
      properties:
        id:
          type: string
          format: uuid
        documentType:
          $ref: '#/components/schemas/EventDocumentTypeDto'
        name:
          type: string
        createdAt:
          type: string
          format: date-time
        createdBy:
          $ref: '#/components/schemas/AppUserNameDto'
        updatedAt:
          type: string
          format: date-time
        updatedBy:
          $ref: '#/components/schemas/AppUserNameDto'
